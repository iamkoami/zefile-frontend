(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[577],{1063:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var r=s(5155),a=s(2115),n=s(5695),l=s(7652),i=s(7930),o=s(9172),c=s(7325),d=s(3464);let u=s(9509).env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:3333";class m{static getInstance(){return m.instance||(m.instance=new m),m.instance}async requestOTP(e){try{return(await d.A.post("".concat(u,"/transfers/recipient/request-otp"),e)).data}catch(e){if(d.A.isAxiosError(e)&&e.response)throw Error(e.response.data.message||"Failed to request OTP");throw Error("Network error. Please try again.")}}async verifyOTP(e){try{return(await d.A.post("".concat(u,"/transfers/recipient/verify-otp"),e)).data}catch(e){if(d.A.isAxiosError(e)&&e.response)throw Error(e.response.data.message||"Failed to verify OTP");throw Error("Network error. Please try again.")}}constructor(){}}let h=m.getInstance();var x=s(8385),p=s(6189),f=s(8393),y=s(6766);let g=e=>{let{files:t,isOpen:s,onClose:n,isPaid:i}=e;(0,l.c)("transferLanding");let[o,c]=(0,a.useState)(0);if(!s||0===t.length)return null;let d=t[o],u=i?d.fileUrl:d.thumbnailUrl,m=d.mimeType.startsWith("image/"),h=d.mimeType.startsWith("video/"),g="application/pdf"===d.mimeType;return(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{backgroundColor:"rgba(0, 0, 0, 0.9)"},onClick:n,children:(0,r.jsxs)("div",{className:"relative w-full h-full max-w-6xl max-h-screen p-8 flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{className:"text-white",children:[(0,r.jsx)("h3",{className:"font-medium text-lg",children:d.filename}),(0,r.jsxs)("p",{className:"text-sm opacity-75",children:[(e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]})(d.size)," â€¢ ",o+1," of ",t.length]})]}),(0,r.jsx)("button",{onClick:n,className:"text-white hover:opacity-75 transition-opacity",children:(0,r.jsx)(x.A,{width:32,height:32,strokeWidth:2})})]}),(0,r.jsxs)("div",{className:"flex-1 flex items-center justify-center mb-4 relative",children:[!i&&(0,r.jsx)("div",{className:"absolute top-4 right-4 px-3 py-1 rounded text-sm font-medium z-10",style:{backgroundColor:"#87E64B",color:"#171717"},children:"Watermarked Preview"}),m&&u&&(0,r.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",children:(0,r.jsx)(y.default,{src:u,alt:d.filename,width:1200,height:800,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"},unoptimized:!0})}),h&&u&&(0,r.jsx)("video",{src:u,controls:!0,className:"max-w-full max-h-full",style:{backgroundColor:"#000"},children:"Your browser does not support the video tag."}),g&&u&&(0,r.jsx)("iframe",{src:u,className:"w-full h-full",style:{border:"none",backgroundColor:"#fff"}}),!m&&!h&&!g&&(0,r.jsxs)("div",{className:"text-white text-center",children:[(0,r.jsx)("p",{className:"text-lg mb-2",children:d.filename}),(0,r.jsx)("p",{className:"text-sm opacity-75",children:"Preview not available for this file type"})]})]}),t.length>1&&(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,r.jsx)("button",{onClick:()=>{c(e=>0===e?t.length-1:e-1)},className:"text-white hover:opacity-75 transition-opacity p-2",children:(0,r.jsx)(p.A,{width:32,height:32,strokeWidth:2})}),(0,r.jsxs)("div",{className:"text-white text-sm",children:[o+1," / ",t.length]}),(0,r.jsx)("button",{onClick:()=>{c(e=>e===t.length-1?0:e+1)},className:"text-white hover:opacity-75 transition-opacity p-2",children:(0,r.jsx)(f.A,{width:32,height:32,strokeWidth:2})})]})]})})};function j(){let e=(0,n.useParams)(),t=(0,l.c)("transferLanding"),s=(0,l.c)("otp"),d=(0,l.c)("currency"),u=e.shortCode,[m,x]=(0,a.useState)("loading"),[p,f]=(0,a.useState)(null),[y,j]=(0,a.useState)(""),[b,v]=(0,a.useState)(""),[w,N]=(0,a.useState)(""),[T,k]=(0,a.useState)(!1),[C,F]=(0,a.useState)(0),[E,A]=(0,a.useState)(!1),[S,P]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=async()=>{try{x("loading");let s=await c.I.getTransferByShortCode(u);if(!s.error&&s.data){if(f(s.data),"expired"===s.data.status){j(t("transferExpired")),x("error");return}x("email-input")}else{var e;j((null==(e=s.error)?void 0:e.message)||t("transferNotFound")),x("error")}}catch(e){j(e instanceof Error?e.message:t("transferNotFound")),x("error")}};u&&e()},[u,t]),(0,a.useEffect)(()=>{if(C>0){let e=setTimeout(()=>F(C-1),1e3);return()=>clearTimeout(e)}},[C]);let B=async e=>{if(e.preventDefault(),b.trim()&&p){k(!0),j("");try{let e=await h.requestOTP({email:b.trim(),shortCode:p.shortCode,purpose:"transfer-access"});e.success&&(F(e.cooldown||60),x("otp-verification"))}catch(e){j(e.message)}finally{k(!1)}}},q=async e=>{if(e.preventDefault(),w.trim()&&p){k(!0),j("");try{(await h.verifyOTP({email:b.trim(),shortCode:p.shortCode,otp:w.trim()})).success&&x("transfer-details")}catch(e){j(e.message)}finally{k(!1)}}},D=async()=>{if(!(C>0)&&p){k(!0),j("");try{let e=await h.requestOTP({email:b.trim(),shortCode:p.shortCode,purpose:"transfer-access"});e.success&&(F(e.cooldown||60),N(""))}catch(e){j(e.message)}finally{k(!1)}}},z=()=>{if(!p)return 0;let e=new Date;return Math.max(0,Math.ceil((new Date(p.expiryDate).getTime()-e.getTime())/864e5))},O=async()=>{if(p){if(!p.price||0===p.price)return void P(!0);alert("Payment integration coming soon! This would integrate with your payment provider.")}};if("loading"===m)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"#F5F5F5"},children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("p",{className:"text-lg",children:t("loading")})})});if("error"===m)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"#F5F5F5"},children:(0,r.jsxs)("div",{className:"ze-panel max-w-md w-full mx-4 p-8 text-center",children:[(0,r.jsx)(i.A,{width:64,height:64,className:"mx-auto mb-4",style:{color:"#171717"}}),(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:y})]})});if("email-input"===m)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"#F5F5F5"},children:(0,r.jsxs)("div",{className:"ze-panel max-w-md w-full mx-4 p-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)(o.A,{width:64,height:64,className:"mx-auto mb-4",style:{color:"#171717"}}),(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2",children:t("downloadFiles")}),(0,r.jsxs)("p",{className:"text-sm",style:{color:"#666"},children:[t("filesExpireIn")," ",z()," ",1===z()?"day":"days"]})]}),(null==p?void 0:p.title)&&(0,r.jsx)("h2",{className:"text-xl font-bold mb-6 text-center",children:p.title}),(0,r.jsxs)("form",{onSubmit:B,children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:t("yourEmail")}),(0,r.jsx)("input",{type:"email",value:b,onChange:e=>v(e.target.value),className:"ze-form-input w-full",placeholder:t("yourEmail"),required:!0})]}),y&&(0,r.jsx)("p",{className:"text-sm text-red-600 mb-4",children:y}),(0,r.jsx)("button",{type:"submit",disabled:T,className:"ze-button-primary w-full",children:T?t("loading"):t("continue")})]})]})});if("otp-verification"===m)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"#F5F5F5"},children:(0,r.jsxs)("div",{className:"ze-panel max-w-md w-full mx-4 p-8",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-2 text-center",children:s("title")}),(0,r.jsxs)("p",{className:"text-sm mb-1 text-center",style:{color:"#666"},children:[s("description")," ",(0,r.jsx)("strong",{children:b})]}),(0,r.jsx)("p",{className:"text-sm mb-6 text-center",style:{color:"#666"},children:s("instruction")}),(0,r.jsxs)("form",{onSubmit:q,children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("input",{type:"text",value:w,onChange:e=>N(e.target.value.replace(/\D/g,"").slice(0,6)),className:"ze-form-input w-full text-center text-2xl tracking-widest",placeholder:"000000",maxLength:6,required:!0})}),y&&(0,r.jsx)("p",{className:"text-sm text-red-600 mb-4 text-center",children:y}),(0,r.jsx)("button",{type:"submit",disabled:T||6!==w.length,className:"ze-button-primary w-full mb-4",children:s(T?"verifying":"checkAndSend")}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("button",{type:"button",onClick:D,disabled:C>0||T,className:"text-sm",style:{color:C>0?"#999":"#171717"},children:C>0?s("waitBeforeResend",{seconds:C}):s("resendCode")})}),(0,r.jsx)("div",{className:"text-center mt-4",children:(0,r.jsx)("button",{type:"button",onClick:()=>x("email-input"),className:"text-sm",style:{color:"#171717"},children:s("backButton")})})]})]})});if("transfer-details"===m&&p){var I;let e=(null==(I=p.files)?void 0:I.length)||0,s=(null==p?void 0:p.files)?(e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]})(p.files.reduce((e,t)=>e+t.size,0)):"0 MB",a=z(),n=p.price||0,l=0===n;return(0,r.jsx)("div",{className:"min-h-screen",style:{backgroundColor:"#F5F5F5",padding:"40px 20px"},children:(0,r.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,r.jsxs)("div",{className:"ze-panel p-8",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)(o.A,{width:64,height:64,className:"mx-auto mb-4",style:{color:"#171717"}}),(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2",children:t("downloadFiles")}),(0,r.jsxs)("p",{className:"text-sm",style:{color:"#666"},children:[t("filesExpireIn")," ",a," ",1===a?t("day"):t("days")]})]}),p.title&&(0,r.jsx)("h2",{className:"text-xl font-bold mb-6",children:p.title}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4 p-4 rounded",style:{backgroundColor:"#F0F0F0"},children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-medium",children:[e," ",1===e?t("file"):t("files")]}),(0,r.jsx)("p",{className:"text-sm",style:{color:"#666"},children:s})]}),(0,r.jsx)("button",{onClick:()=>A(!0),className:"px-4 py-2 rounded font-medium hover:opacity-80 transition-opacity",style:{backgroundColor:"white",color:"#171717"},children:t("preview")})]}),(0,r.jsx)("div",{className:"mb-6 text-center",children:(0,r.jsxs)("button",{className:"text-sm flex items-center gap-2 mx-auto",style:{color:"#666"},children:[(0,r.jsx)(i.A,{width:16,height:16}),t("reportTransfer")]})}),S?(0,r.jsx)("button",{onClick:()=>{if(!S&&(null==p?void 0:p.price)&&p.price>0)return void alert("Please complete payment first");alert("Download functionality coming soon!")},className:"ze-button-primary w-full",children:"Download Files"}):(0,r.jsx)("button",{onClick:O,className:"ze-button-primary w-full",children:l?t("payAndDownload"):"".concat(t("payAndDownload")," - ").concat(n," ").concat(d("cfa"))}),p.message&&(0,r.jsx)("div",{className:"mt-6 p-4 rounded",style:{backgroundColor:"#F0F0F0"},children:(0,r.jsx)("p",{className:"text-sm",style:{color:"#666"},children:p.message})})]}),p.files&&p.files.length>0&&(0,r.jsx)(g,{files:p.files,isOpen:E,onClose:()=>A(!1),isPaid:S})]})})}return null}},5499:(e,t,s)=>{"use strict";s.d(t,{u:()=>a});class r{setAccessToken(e){this.accessToken=e,e?localStorage.setItem("access_token",e):localStorage.removeItem("access_token")}getAccessToken(){return this.accessToken?this.accessToken:localStorage.getItem("access_token")}async request(e,t,s){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a="".concat(this.baseURL).concat(t),n=this.getAccessToken(),l={"Content-Type":"application/json",...r.headers};n&&(l.Authorization="Bearer ".concat(n));let i=new AbortController,o=setTimeout(()=>i.abort(),this.timeout);try{let t=await fetch(a,{method:e,headers:l,body:s?JSON.stringify(s):void 0,signal:i.signal,...r});clearTimeout(o);let n=await t.json().catch(()=>null);if(!t.ok)return{error:{message:(null==n?void 0:n.message)||"An error occurred",statusCode:t.status,error:null==n?void 0:n.error},status:t.status};return{data:n,status:t.status}}catch(e){if(clearTimeout(o),"AbortError"===e.name)return{error:{message:"Request timeout",statusCode:408},status:408};return{error:{message:e.message||"Network error",statusCode:0},status:0}}}async get(e,t){return this.request("GET",e,void 0,t)}async post(e,t,s){return this.request("POST",e,t,s)}async patch(e,t,s){return this.request("PATCH",e,t,s)}async delete(e,t){return this.request("DELETE",e,void 0,t)}async upload(e,t,s){let r="".concat(this.baseURL).concat(e),a=this.getAccessToken();return new Promise(e=>{let n=new XMLHttpRequest;s&&n.upload.addEventListener("progress",e=>{e.lengthComputable&&s(e.loaded/e.total*100)}),n.addEventListener("load",()=>{try{let t=JSON.parse(n.responseText);n.status>=200&&n.status<300?e({data:t,status:n.status}):e({error:{message:(null==t?void 0:t.message)||"Upload failed",statusCode:n.status,error:null==t?void 0:t.error},status:n.status})}catch(t){e({error:{message:"Failed to parse response",statusCode:n.status},status:n.status})}}),n.addEventListener("error",()=>{e({error:{message:"Network error",statusCode:0},status:0})}),n.addEventListener("timeout",()=>{e({error:{message:"Request timeout",statusCode:408},status:408})}),n.open("POST",r),n.timeout=this.timeout,a&&n.setRequestHeader("Authorization","Bearer ".concat(a)),n.send(t)})}constructor(){this.accessToken=null,this.baseURL="http://localhost:3001",this.timeout=parseInt("30000")}}let a=new r},5925:(e,t,s)=>{Promise.resolve().then(s.bind(s,1063))},7325:(e,t,s)=>{"use strict";s.d(t,{I:()=>n});var r=s(5499);class a{async createTransfer(e){return r.u.post("/transfers",e)}async createTransferWithFiles(e,t){let s=new FormData;return s.append("senderId",e.senderId),s.append("recipientEmails",JSON.stringify(e.recipientEmails)),s.append("title",e.title||"Untitled Transfer"),e.price&&s.append("price",e.price.toString()),e.currency&&s.append("currency",e.currency),e.message&&s.append("message",e.message),e.password&&s.append("password",e.password),e.expiryDate&&s.append("expiryDate",e.expiryDate),e.maxDownloads&&s.append("maxDownloads",e.maxDownloads.toString()),e.files.forEach(e=>{s.append("files",e)}),r.u.upload("/transfers/with-files",s,t)}async getAllTransfers(){return r.u.get("/transfers")}async getTransferById(e){return r.u.get("/transfers/".concat(e))}async getTransfersBySender(e){return r.u.get("/transfers/user/".concat(e))}async getTransfersByRecipient(e){return r.u.get("/transfers/recipient/".concat(e))}async getTransfersByStatus(e){return r.u.get("/transfers/status/".concat(e))}async updateTransfer(e,t){return r.u.patch("/transfers/".concat(e),t)}async updateTransferStatus(e,t){return r.u.patch("/transfers/".concat(e,"/status/").concat(t))}async deleteTransfer(e){return r.u.delete("/transfers/".concat(e))}async getTransferByShortCode(e){return r.u.get("/transfers/code/".concat(e))}async requestTransferOTP(e){return r.u.post("/transfers/request-otp",e)}async verifyTransferOTP(e){return r.u.post("/transfers/verify-otp",e)}}let n=new a}},e=>{var t=t=>e(e.s=t);e.O(0,[683,335,498,441,684,358],()=>t(5925)),_N_E=e.O()}]);